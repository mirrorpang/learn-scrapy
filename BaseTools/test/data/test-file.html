<section class="col-article"><div class="col-markdown-nav absolute" style="position: fixed; top: 74px; left: 1080px; max-height: 281px;"><h2 class="nav-title">在这篇文章中：</h2><ul class="col-markdown-nav-list"><li><a href="javascript:;" title="例子：" data-key="2.1">例子：</a><ul><li><a href="javascript:;" title="1. 基本的匹配（Query）查询" data-key="3.1" class="">1. 基本的匹配（Query）查询</a></li><li><a href="javascript:;" title="2. 多字段（Multi-filed）查询" data-key="3.2" class="">2. 多字段（Multi-filed）查询</a></li><li><a href="javascript:;" title="3. Boosting" data-key="3.3" class="">3. Boosting</a></li><li><a href="javascript:;" title="4. Bool 查询" data-key="3.4" class="">4. Bool 查询</a></li><li><a href="javascript:;" title="5. 模糊（Fuzzy）查询" data-key="3.5" class="">5. 模糊（Fuzzy）查询</a></li><li><a href="javascript:;" title="6. 通配符（Wildcard）查询" data-key="3.6" class="active">6. 通配符（Wildcard）查询</a></li><li><a href="javascript:;" title="7. 正则（Regexp）查询" data-key="3.7" class="">7. 正则（Regexp）查询</a></li><li><a href="javascript:;" title="8. 短语匹配(Match Phrase)查询" data-key="3.8" class="">8. 短语匹配(Match Phrase)查询</a></li><li><a href="javascript:;" title="9. 短语前缀（Match Phrase Prefix）查询" data-key="3.9" class="">9. 短语前缀（Match Phrase Prefix）查询</a></li><li><a href="javascript:;" title="10. 查询字符串（Query String）" data-key="3.10" class="">10. 查询字符串（Query String）</a></li><li><a href="javascript:;" title="11. 简单查询字符串（Simple Query String）" data-key="3.11" class="">11. 简单查询字符串（Simple Query String）</a></li><li><a href="javascript:;" title="12. 词条（Term）/多词条（Terms）查询" data-key="3.12" class="">12. 词条（Term）/多词条（Terms）查询</a></li></ul></li></ul></div><div class="c-markdown J-articleContent"><p>为了演示不同类型的 <strong>ElasticSearch</strong> 的查询，我们将使用书文档信息的集合（有以下字段：<strong>title</strong>（标题）, <strong>authors</strong>（作者）, <strong>summary</strong>（摘要）, <strong>publish_date</strong>（发布日期）和 <strong>num_reviews</strong>（浏览数））。</p><p>在这之前，首先我们应该先创建一个新的索引（index），并批量导入一些文档：</p><p>创建索引：</p><pre class="prism-token token  language-javascript">PUT <span class="token operator">/</span>bookdb_index
    <span class="token punctuation">{</span> <span class="token string">"settings"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"number_of_shards"</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> </pre><p>批量上传文档：</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_bulk
    <span class="token punctuation">{</span> <span class="token string">"index"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"clinton gormley"</span><span class="token punctuation">,</span> <span class="token string">"zachary tong"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span><span class="token punctuation">,</span> <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"oreilly"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"index"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Taming Text: How to Find, Organize, and Manipulate It"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"grant ingersoll"</span><span class="token punctuation">,</span> <span class="token string">"thomas morton"</span><span class="token punctuation">,</span> <span class="token string">"drew farris"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token string">"organize text using approaches such as full-text search, proper name recognition, clustering, tagging, information extraction, and summarization"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">:</span> <span class="token string">"2013-01-24"</span><span class="token punctuation">,</span> <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"index"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"radu gheorge"</span><span class="token punctuation">,</span> <span class="token string">"matthew lee hinman"</span><span class="token punctuation">,</span> <span class="token string">"roy russo"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token string">"build scalable search applications using Elasticsearch without having to do complex low-level programming or understand advanced data science algorithms"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span><span class="token punctuation">,</span> <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"index"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"trey grainger"</span><span class="token punctuation">,</span> <span class="token string">"timothy potter"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span><span class="token punctuation">,</span> <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span> <span class="token punctuation">}</span></pre><h2><strong>例子：</strong></h2><h3><strong>1. 基本的匹配（Query）查询</strong></h3><p>有两种方式来执行一个全文匹配查询：</p><ul class="ul-level-0" style="margin:10px 0 10px 20px"><li>使用 <strong>Search Lite API</strong>，它从 <code>url</code> 中读取所有的查询参数</li><li>使用完整 <strong>JSON</strong> 作为请求体，这样你可以使用完整的 <strong>Elasticsearch DSL</strong></li></ul><p>下面是一个基本的匹配查询，查询任一字段包含 Guide 的记录</p><pre class="prism-token token  language-javascript">GET <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search<span class="token operator">?</span>q<span class="token operator">=</span>guide

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.28168046</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"clinton gormley"</span><span class="token punctuation">,</span> <span class="token string">"zachary tong"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.24144039</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"trey grainger"</span><span class="token punctuation">,</span> <span class="token string">"timothy potter"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p>下面是完整 Body 版本的查询，生成相同的内容：</p><pre class="prism-token token  language-javascript"><span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"multi_match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span> <span class="token punctuation">:</span> <span class="token string">"guide"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"_all"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre><p><code>multi_match</code> 是 <code>match</code> 的作为在多个字段运行相同操作的一个速记法。<code>fields</code> 属性用来指定查询针对的字段，在这个例子中，我们想要对文档的所有字段进行匹配。两个 <strong>API</strong> 都允许你指定要查询的字段。例如，查询 <code>title</code> 字段中包含 <strong>in Action</strong> 的书：</p><pre class="prism-token token  language-javascript">GET <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search<span class="token operator">?</span>q<span class="token operator">=</span>title<span class="token punctuation">:</span><span class="token keyword">in</span> action

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.6259885</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"trey grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"timothy potter"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.5975345</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"radu gheorge"</span><span class="token punctuation">,</span>
            <span class="token string">"matthew lee hinman"</span><span class="token punctuation">,</span>
            <span class="token string">"roy russo"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"build scalable search applications using Elasticsearch without having to do complex low-level programming or understand advanced data science algorithms"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p>然而， 完整的 <strong>DSL</strong> 给予你灵活创建更复杂查询和指定返回结果的能力（后面，我们会一一阐述）。在下面例子中，我们指定 <code>size</code>限定返回的结果条数，from 指定起始位子，<code>_source</code> 指定要返回的字段，以及语法高亮</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"title"</span> <span class="token punctuation">:</span> <span class="token string">"in action"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"size"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"from"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"title"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"total"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"max_score"</span><span class="token punctuation">:</span> <span class="token number">0.9105287</span><span class="token punctuation">,</span>
    <span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.9105287</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"build scalable search applications using Elasticsearch without having to do complex low-level programming or understand advanced data science algorithms"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"Elasticsearch &lt;em&gt;in&lt;/em&gt; &lt;em&gt;Action&lt;/em&gt;"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.9105287</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"Solr &lt;em&gt;in&lt;/em&gt; &lt;em&gt;Action&lt;/em&gt;"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span></pre><p>注意：对于多个词查询，<code>match</code> 允许指定是否使用 <code>and</code> 操作符来取代默认的 <code>or</code> 操作符。你还可以指定 <code>mininum_should_match</code> 选项来调整返回结果的相关程度。具体看后面的例子。</p><h3><strong>2. 多字段（Multi-filed）查询</strong></h3><p>正如我们已经看到来的，为了根据多个字段检索（e.g. 在 <code>title</code> 和 <code>summary</code> 字段都是相同的查询字符串的结果），你可以使用 <code>multi_match</code> 语句</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"multi_match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span> <span class="token punctuation">:</span> <span class="token string">"elasticsearch guide"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"total"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"max_score"</span><span class="token punctuation">:</span> <span class="token number">0.9448582</span><span class="token punctuation">,</span>
    <span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.9448582</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"clinton gormley"</span><span class="token punctuation">,</span>
            <span class="token string">"zachary tong"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.17312013</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"radu gheorge"</span><span class="token punctuation">,</span>
            <span class="token string">"matthew lee hinman"</span><span class="token punctuation">,</span>
            <span class="token string">"roy russo"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"build scalable search applications using Elasticsearch without having to do complex low-level programming or understand advanced data science algorithms"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.14965448</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"trey grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"timothy potter"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span></pre><p><strong>注：</strong>第三条被匹配，因为 <code>guide</code> 在 <code>summary</code> 字段中被找到。</p><h3><strong>3. Boosting</strong></h3><p>由于我们是多个字段查询，我们可能需要提高某一个字段的分值。在下面的例子中，我们把 <code>summary</code> 字段的分数提高三倍，为了提升 <code>summary</code> 字段的重要度；因此，我们把文档 4 的相关度提高了。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"multi_match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span> <span class="token punctuation">:</span> <span class="token string">"elasticsearch guide"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary^3"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.31495273</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.14965448</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.13094766</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"build scalable search applications using Elasticsearch without having to do complex low-level programming or understand advanced data science algorithms"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p><strong>注：</strong>提升不是简简单单通过提升因子把计算分数加成。实际的 <code>boost</code> 值通过归一化和一些内部优化给出的。相关信息请见 Elasticsearch guide</p><h3><strong>4. Bool 查询</strong></h3><p>为了提供更相关或者特定的结果，<code>AND</code>/<code>OR</code>/<code>NOT</code> 操作符可以用来调整我们的查询。它是以 <strong>布尔查询</strong> 的方式来实现的。<strong>布尔查询</strong> 接受如下参数：</p><ul class="ul-level-0" style="margin:10px 0 10px 20px"><li><code>must</code> 等同于 <code>AND</code></li><li><code>must_not</code> 等同于 <code>NOT</code></li><li><code>should</code> 等同于 <code>OR</code></li></ul><p>打比方，如果我想要查询这样类型的书：书名包含 <strong>ElasticSearch</strong> 或者（<code>OR</code>） <strong>Solr</strong>，并且（<code>AND</code>）它的作者是 <strong>Clinton Gormley</strong>不是（<code>NOT</code>）<strong>Radu Gheorge</strong></p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"bool"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"must"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"bool"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"should"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                      <span class="token punctuation">{</span> <span class="token string">"match"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">{</span> <span class="token string">"match"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"must"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"match"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token string">"clinton gormely"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"must_not"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"match"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token string">"radu gheorge"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.3672021</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"clinton gormley"</span><span class="token punctuation">,</span>
            <span class="token string">"zachary tong"</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span><span class="token punctuation">,</span>
          <span class="token string">"num_reviews"</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"oreilly"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p><strong>注</strong>：正如你所看到的，<strong>布尔查询</strong> 可以包装任何其他查询类型，包括其他布尔查询，以创建任意复杂或深度嵌套的查询。</p><h3><strong>5. 模糊（Fuzzy）查询</strong></h3><p>在进行匹配和多项匹配时，可以启用模糊匹配来捕捉拼写错误，模糊度是基于原始单词的编辑距离来指定的。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"multi_match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span> <span class="token punctuation">:</span> <span class="token string">"comprihensiv guide"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"fuzziness"</span><span class="token punctuation">:</span> <span class="token string">"AUTO"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"size"</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.5961596</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">]</span></pre><p><strong>注</strong>：当术语长度大于 5 个字符时，<code>AUTO</code> 的模糊值等同于指定值 “2”。但是，80％ 拼写错误的编辑距离为 1，所以，将模糊值设置为 <code>1</code>可能会提高您的整体搜索性能。更多详细信息，请参阅<strong>Elasticsearch指南中的“排版和拼写错误”（Typos and Misspellings）</strong>。</p><h3><strong>6. 通配符（Wildcard）查询</strong></h3><p><strong>通配符查询</strong> 允许你指定匹配的模式，而不是整个术语。</p><ul class="ul-level-0" style="margin:10px 0 10px 20px"><li><code>？</code> 匹配任何字符</li><li><code>*</code> 匹配零个或多个字符。</li></ul><p>例如，要查找名称以字母’t’开头的所有作者的记录：</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"wildcard"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"authors"</span> <span class="token punctuation">:</span> <span class="token string">"t*"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"authors"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"clinton gormley"</span><span class="token punctuation">,</span>
            <span class="token string">"zachary tong"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"zachary &lt;em&gt;tong&lt;/em&gt;"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Taming Text: How to Find, Organize, and Manipulate It"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"grant ingersoll"</span><span class="token punctuation">,</span>
            <span class="token string">"thomas morton"</span><span class="token punctuation">,</span>
            <span class="token string">"drew farris"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"&lt;em&gt;thomas&lt;/em&gt; morton"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"trey grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"timothy potter"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"&lt;em&gt;trey&lt;/em&gt; grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"&lt;em&gt;timothy&lt;/em&gt; potter"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span> </pre><h3><strong>7. 正则（Regexp）查询</strong></h3><p><strong>正则查询</strong> 让你可以使用比 <strong>通配符查询</strong> 更复杂的模式进行查询：</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"regexp"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"authors"</span> <span class="token punctuation">:</span> <span class="token string">"t[a-z]*y"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"authors"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"trey grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"timothy potter"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"&lt;em&gt;trey&lt;/em&gt; grainger"</span><span class="token punctuation">,</span>
            <span class="token string">"&lt;em&gt;timothy&lt;/em&gt; potter"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><h3><strong>8. 短语匹配(Match Phrase)查询</strong></h3><p><strong>短语匹配查询</strong> 要求在请求字符串中的所有查询项必须都在文档中存在，文中顺序也得和请求字符串一致，且彼此相连。默认情况下，查询项之间必须紧密相连，但可以设置 <code>slop</code> 值来指定查询项之间可以分隔多远的距离，结果仍将被当作一次成功的匹配。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"multi_match"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token string">"search engine"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"phrase"</span><span class="token punctuation">,</span>
            <span class="token string">"slop"</span><span class="token punctuation">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.22327082</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.16113183</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p><strong>注</strong>：在上述例子中，对于非整句类型的查询，<code>_id</code> 为 1 的文档一般会比 <code>_id</code> 为 4 的文档得分高，结果位置也更靠前，因为它的字段长度较短，但是对于 <strong>短语匹配类型</strong> 查询，由于查询项之间的接近程度是一个计算因素，因此 <code>_id</code> 为 4 的文档得分更高。</p><h3><strong>9. 短语前缀（Match Phrase Prefix）查询</strong></h3><p><strong>短语前缀式查询</strong> 能够进行 <strong>即时搜索（search-as-you-type）</strong> 类型的匹配，或者说提供一个查询时的初级自动补全功能，无需以任何方式准备你的数据。和 <code>match_phrase</code> 查询类似，它接收<code>slop</code> 参数（用来调整单词顺序和不太严格的相对位置）和 <code>max_expansions</code>参数（用来限制查询项的数量，降低对资源需求的强度）。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"match_phrase_prefix"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token string">"search en"</span><span class="token punctuation">,</span>
                <span class="token string">"slop"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token string">"max_expansions"</span><span class="token punctuation">:</span> <span class="token number">10</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"publish_date"</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.5161346</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"Comprehensive guide to implementing a scalable search engine using Apache Solr"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.37248808</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"A distibuted real-time search and analytics engine"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch: The Definitive Guide"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-02-07"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p><strong>注</strong>：采用 <strong>查询时即时搜索</strong> 具有较大的性能成本。更好的解决方案是采用 <strong>索引时即时搜索</strong>。更多信息，请查看 <strong>自动补齐接口（Completion Suggester API）</strong> 或 <strong>边缘分词器（Edge-Ngram filters）的用法</strong>。</p><h3><strong>10. 查询字符串（Query String）</strong></h3><p><strong>查询字符串</strong> 类型（<strong>query_string</strong>）的查询提供了一个方法，用简洁的简写语法来执行 <strong>多匹配查询</strong>、 <strong>布尔查询</strong> 、 <strong>提权查询</strong>、 <strong>模糊查询</strong>、 <strong>通配符查询</strong>、 <strong>正则查询</strong> 和<strong>范围查询</strong>。下面的例子中，我们在那些作者是 <strong>“grant ingersoll”</strong> 或 <strong>“tom morton”</strong> 的某本书当中，使用查询项 <strong>“search algorithm”</strong> 进行一次模糊查询，搜索全部字段，但给 <code>summary</code> 的权重提升 2 倍。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"query_string"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token string">"(saerch~1 algorithm~1) AND (grant ingersoll)  OR (tom morton)"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"_all"</span><span class="token punctuation">,</span> <span class="token string">"summary^2"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">0.14558059</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token string">"organize text using approaches such as full-text search, proper name recognition, clustering, tagging, information extraction, and summarization"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Taming Text: How to Find, Organize, and Manipulate It"</span><span class="token punctuation">,</span>
          <span class="token string">"authors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"grant ingersoll"</span><span class="token punctuation">,</span>
            <span class="token string">"thomas morton"</span><span class="token punctuation">,</span>
            <span class="token string">"drew farris"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"summary"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">"organize text using approaches such as full-text &lt;em&gt;search&lt;/em&gt;, proper name recognition, clustering, tagging, information extraction, and summarization"</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><h3><strong>11. 简单查询字符串（Simple Query String）</strong></h3><p><strong>简单请求字符串</strong> 类型（<strong>simple_query_string</strong>）的查询是请求<strong>字符串类型</strong>（<strong>query_string</strong>）查询的一个版本，它更适合那种仅暴露给用户一个简单搜索框的场景；因为它用 <code>+/\|/-</code> 分别替换了 <code>AND/OR/NOT</code>，并且自动丢弃了请求中无效的部分，不会在用户出错时，抛出异常。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"simple_query_string"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token string">"(saerch~1 algorithm~1) + (grant ingersoll)  | (tom morton)"</span><span class="token punctuation">,</span>
            <span class="token string">"fields"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"_all"</span><span class="token punctuation">,</span> <span class="token string">"summary^2"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"summary"</span><span class="token punctuation">,</span> <span class="token string">"authors"</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"highlight"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"fields"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"summary"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> </pre><h3><strong>12. 词条（Term）/多词条（Terms）查询</strong></h3><p>以上例子均为 <code>full-text</code>(全文检索) 的示例。有时我们对结构化查询更感兴趣，希望得到更准确的匹配并返回结果，<strong>词条查询</strong> 和 <strong>多词条查询</strong> 可帮我们实现。在下面的例子中，我们要在索引中找到所有由 <strong>Manning</strong> 出版的图书。</p><pre class="prism-token token  language-javascript">POST <span class="token operator">/</span>bookdb_index<span class="token operator">/</span>book<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"term"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"_source"</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span><span class="token string">"publish_date"</span><span class="token punctuation">,</span><span class="token string">"publisher"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span>Results<span class="token punctuation">]</span>
<span class="token string">"hits"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1.2231436</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Taming Text: How to Find, Organize, and Manipulate It"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2013-01-24"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1.2231436</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Elasticsearch in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2015-12-03"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string">"_index"</span><span class="token punctuation">:</span> <span class="token string">"bookdb_index"</span><span class="token punctuation">,</span>
        <span class="token string">"_type"</span><span class="token punctuation">:</span> <span class="token string">"book"</span><span class="token punctuation">,</span>
        <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
        <span class="token string">"_score"</span><span class="token punctuation">:</span> <span class="token number">1.2231436</span><span class="token punctuation">,</span>
        <span class="token string">"_source"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token string">"manning"</span><span class="token punctuation">,</span>
          <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Solr in Action"</span><span class="token punctuation">,</span>
          <span class="token string">"publish_date"</span><span class="token punctuation">:</span> <span class="token string">"2014-04-05"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span></pre><p>可使用词条关键字来指定多个词条，将搜索项用数组传入。</p><pre class="prism-token token  language-javascript"><span class="token punctuation">{</span>
    <span class="token string">"query"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"terms"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"publisher"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"oreilly"</span><span class="token punctuation">,</span> <span class="token string">"packt"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> </pre><figure><div class="image-block"><span><img src="https://ask.qcloudimg.com/http-save/yehe-2511396/ka568ygtz8.gif" class="" style="cursor: zoom-in;"></span></div></figure><p>- 下节再续 -</p><p></p><figure></figure><figure></figure></div><div class="col-article-source"><p>原文发布于微信公众号 - <!-- -->我的小碗汤（mysmallsoup）</p><p>原文发表时间：<!-- -->2018-09-08</p><p>本文参与<a href="/developer/support-plan" class="com-link">腾讯云自媒体分享计划</a>，欢迎正在阅读的你也加入，一起分享。</p></div><div class="col-article-time"><span>发表于 <time datetime="2018-09-30 10:33:09" title="2018-09-30 10:33:09"> 2018-09-30<span class="com-v-box">2018-09-30 10:33:09</span></time></span></div><div class="col-article-tags"><nav class="col-tags"><a href="/developer/tag/125?entry=article" class="col-tag">其他</a></nav><div class="extra-part"><div class="com-operations"><a href="javascript:;" class="com-opt-link link-warn"><i class="com-i-warn"></i>举报</a></div></div></div><div class="com-widget-operations" style="top: 114px;"><div class="main-cnt"><a href="javascript:;" class="com-opt-link link-like"><i class="com-i-like"></i><span class="text">5</span></a></div><div class="extra-cnt"><span class="com-opt-text share-text">分享</span><ul class="com-share-options"><li><div class="c-bubble-trigger"><a href="javascript:;" class="opt-item"><i class="opt-icon wechat"></i></a><div class="c-bubble c-bubble-left "><div class="c-bubble-inner"><div class="qr-img" title="https://cloud.tencent.com/developer/article/1350622"><canvas width="100" height="100" style="display: none;"></canvas><img alt="Scan me!" style="display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAHF0lEQVR4Xu2dbZPiMAyD4f//6L3heJk0daTHSYDZHd/Ho6SNZVuSW7rXy+Xyc1n89/NzXOJ6vZ5WbI9Rn7efPb/z/D+3xvOk/fW0FxOtT7dPr5uuFx13i1wBAiP4UUBUVoVINlVAM7LPYJetfWW4ynuuHx0X7SG67uw5+iq+nWcllq8KWVmkALlcXHKpImy/ewLEZRfJCMUDbQZlzxVxiEukiH9gh3odRtZwe1YVWoAkESlAHgEjKqsq5CFxac9U2eXWUC2NtE5XCGT92xq/vkIi3e8Ujfu8D24BMmgjGZJWxo1koQOa+ARqLl11KTMcJctXSN2ppgLkCEsE3FbZW4DcA761QlypRm6YGEPHEU4tteTaXiP53mhPWcFBWuKvceoFyDjVQ2NIK4OQk3PUanqrvuvcsFJes+ccyV4yZ5uJ6dZp7yc3TYIf9fNPJMsMEC8q2Dl+L0BWoLh/9/qzword+SnpKfkbbYmuS6uGyG8a2o3hK0Cc0CCgvB2Q7A0ad9HZEYeab62Quqq8GfeuvEZ2z+21nVpWAXJ+HoAoy8gbueFpmCSzpO7Uiquc/nMqCHpj6trODtOq9rLiyuXoJBvAAuQesQLkkTnZsQflkL4CXaJuB+Qpe2dbRtQ7nXSlyqTns9nv0aCOjiPgz1xb2G4LEP/YzkcBeZK6IkeHPpnrUPKlI/xZcznDfbPdg8btIHsLkLkK2VE1UfLJB+XobdWqkCP7ZOMWGkPVKpyTdaV5O2G2FSkzNlrvXZ6DzMhcDHB8e1LfHYisjCQm7E8D0nMInRepwM2ska0gkrUuubJ7cHJeCQ06sZYPOcwOyQqQ8y88CpBB+rteH7VYwk3OIGNAFIdkxwI7NpNtM9mJKp1mH5TP47cwO4CJ1sUqqwC5h4rI2BWgQ2OYVTfOeffrzbSKniRXNj2bXE6y03XpZAE9dULHDVRrU3VTgAAiJCODLA+4vqqy0FUemSLMEDJJlpk4oGd7XXvqA+YqSg3rVHAcgdN1afuIRErmu1PXq4whNToFSNxapgAhslf1/EiFOPKlbY+0KmdCs62FmuF+j64rUEvweurEBZEQMQmgk5ErASbndyOarwPSP3Xi+EIR1c7Mj4h+Jgtp21WVpGJCZ2pOfLwqqAA5pli2QgqQR/xoNf7aCsElFcx1yGghanW0nytCzK6RFSij44m/iVqs9TzqnroKIu3nRAyMjumThBK+2zS5JpegbwNkx2NA2SloxlyNVBkdZ6vgE1XWnj8C2lWoq8j+85PspZnvTE/UZvqTuyzs16AtgAapAOkQKUDO9bP1MSDlUbKlG7WKd3mkyPPQ612RvVElFyBd5Gm763nQCQ6aTOh+iCMzQuoz3KQ4h957IQGmwcruwR0fTqezP9ihTpYQMg1EpMoKkEdUCpB7IMikYKlCVsiJEKCTydlp87uPd3vKTifC9hRNPd7x5GK0mQLk/mNSWzUEECoLqdFS2aeAo0rGgX9yx8E7iLPncp4Kc14BEr9z92uAkKffqeEjRBdJ6FEFkuGi6/VE7WX3N2MDiPz+LxYKkBhSKsmp6ixABg7cDSgjz9NX2UcqJDppVgrTkXg2q1S20kxWrW0HITshQdu5fNdJAXI0gYprtgGiRic0M2l/VLMp512IhidrUBGwUnlZ+d/GTw4XC5AjfDTxChCR9jSIpHrpWlsBcQSnFAdVKFlSzxKy6+fKm9ApAt2rAjoC+NSyCpAxJHSgicckwR9Pm1ZZI3fdky8lWnKTa7ejpllO1KYbGipbcYhl/1ZSOsMpQO4/faZj9QKkK6cVov1ohez4wQ4h3SzRuvZEFU/fligPRB0g603c8eHnBcjc65l2qk3JITQzqOOlx5FZz4oCJG2HXmt7HG2FdM4nXzWevW88syHiCbLXQTevgkn3UoCASP0JQEjLALH4f4hrLUoqqnbgSNIJgVamtteZFQg0DjPHyaffCXGRIPTHFCBjqN7y5ypmMpkA60yrWoPyEDV6ZD1XeRH/FCAdil8HJPtsL8nCGVlI+u1KhUTtl1YyUVL02tzMK/30ewFyjEDW3xQgjz+m/OsqxEnVkVJyMtcR23Pd2bbQXhfxH9k21Upll92zMTrsIfuzaJppWclcgNwjht6X5Ug6W12EwKPMd+fZUSGqgqIKye7FxbIA6V6DXoCAFCMmrO31Kgsdh/wpQEjLcCJAkbRrGTSYhN9mzqVIHeTdfg4pQI5hpwpTqiy3CDFCNLucu+0z3l1b1rT2kptK6JEU7ivPiZCoUreS+uwUt21j6t57ARKkXFXIwy+I98FTEYIqBJNP8EPJ6Lv0xhct79W24Nw2DSY5TlX7qO3Jd50ocNzJSODoGlmg6fF01E7XUyqLKsCt014iJyOPMPIQ/QZdFdFqJF1gVyWpxAwTYuf9kAJkDDWtxqqQQQy/VSH/APVfyjf6OB18AAAAAElFTkSuQmCC"></div><p class="qr-txt">分享文章到朋友圈</p></div></div></div></li><li><div class="c-bubble-trigger"><a href="javascript:;" class="opt-item"><i class="opt-icon qq"></i></a><div class="c-bubble c-bubble-left "><div class="c-bubble-inner"><span>分享文章到 QQ</span></div></div></div></li><li><div class="c-bubble-trigger"><a href="javascript:;" class="opt-item"><i class="opt-icon weibo"></i></a><div class="c-bubble c-bubble-left "><div class="c-bubble-inner"><span>分享文章到微博</span></div></div></div></li><li><div class="c-bubble-trigger"><a class="opt-item" href="javascript:;"><i class="opt-icon copy"></i></a><div class="c-bubble c-bubble-left "><div class="c-bubble-inner"><span>复制文章链接到剪贴板</span></div></div></div></li></ul><div class="c-bubble-trigger com-widget-qr"><button class="scan-btn" hotrep="community.edge-widget.follow-oa">扫描二维码</button><div class="c-bubble c-bubble-left "><div class="c-bubble-inner"><div class="qr-img"><img src="//imgcache.qq.com/open_proj/proj_qcloud_v2/community/portal/css/img/wechat-qr.jpg" alt=""></div><p class="qr-txt">扫码关注云+社区</p><p class="qr-txt">领取腾讯云代金券</p></div></div></div></div></div></section>